# APT
An advanced persistent threat (APT) is a type of attack campaign in which an unauthorized user gains access to a network and remains there undetected for a prolonged period of time. These attacks are often orchestrated by highly skilled and well-funded adversaries and are designed to achieve specific objectives, such as espionage or data theft. While APT attacks can be difficult to detect and defend against, there are a number of steps organizations can take to reduce their risk of becoming a victim.

To effectively attack and get access to the target system, attackers must go through each phase step by step:
1. Preparation
2. Intrusion
3. Expansion
4. Persistence
5. Search and Exfiltration
6. Cleanup

# Trojan
- **Function**: Malicious software disguised as a legitimate program to trick users into installing it.
- **Propagation**: Does not self-replicate; relies on social engineering to spread.
- **Example**: Downloaders & Droppers => Trojan.Downloader.
- In simple words, I will create a game which when executed by the user creates a reverse shell to my C2 server and then upload this game to a forum and boom!

## Downloaders & Droppers
In the context of cybersecurity and malware, the terms "dropper" and "downloader" refer to different types of malicious software designed to install other malware on a target system. Here's a brief explanation of the differences between them:

#### Dropper
- **Function**: A dropper is a type of malware designed to install another malicious payload on the victim's system. It typically carries the malicious payload within its own code.
- **Operation**: Once executed, the dropper extracts and installs the payload directly onto the system.
- **Payload Delivery**: The payload is usually embedded within the dropper itself, making it a self-contained malware delivery mechanism.

#### Downloader
- **Function**: A downloader is a type of malware that, upon execution, retrieves additional malicious software from the internet or another network location.
- **Operation**: The downloader contacts a remote server to download the additional malware, which it then installs on the system.
- **Payload Delivery**: Unlike droppers, downloaders do not contain the malicious payload initially; they fetch it from an external source after being executed.

#### Key Differences
- **Embedded Payload**: Droppers contain the payload within themselves, while downloaders fetch the payload from an external location.
- **Network Activity**: Downloaders require network access to download the additional malware, whereas droppers do not necessarily need network access to deliver the payload.

In summary, a dropper is a self-contained malware installer, while a downloader fetches and installs malware from a remote source.

#### Cryptors 
Cryptors are tools or components used to encrypt malicious payloads. The primary purpose of a cryptor is to obfuscate malware to evade detection by antivirus software and other security mechanisms. Cryptors work by transforming the code of the malware into a format that is not recognizable by signature-based detection methods. Once the encrypted payload reaches the target system, the cryptor decrypts it, allowing the malware to execute.

# Viruses & Worms
- **Viruses**: Malicious software that attaches itself to legitimate files and requires user action to spread.
- **Worms**: Self-replicating malware that spreads automatically across networks without user intervention.
- **Difference**: Viruses need host files and user action, while worms spread independently.

### Virus Lifecycle
1. **Infection**: Virus attaches to a host file or system.
2. **Trigger**: Virus is activated by specific conditions or actions.
3. **Payload Execution**: Virus performs its malicious activity.
4. **Replication**: Virus copies itself to other files or systems.

### Types and Examples
- **Boot Sector Virus**: Infects the master boot record. Example: CIH (Chernobyl) Virus.
- **File-Level Virus**: Infects executable files. Example: FileInfector.
- **Macro Virus**: Infects documents with macros. Example: Melissa Virus.
- **Polymorphic Virus**: Changes its code using encryption each time it infects a new system or file which evades detection by signature-based antivirus programs (Alters only the encryption). Example: Storm Worm.
- **Metamorphic Virus**: Rewrites its own code completely each time it infects a new system or file. Example: Simile.
- **Logic Bomb**: Triggers malicious action under specific conditions. Example: Time Bomb.
- **Ransomware**: Encrypts files and demands a ransom. Example: WannaCry.

# Fileless Malware
In simple words, The malicious code being executed is being pushed into a memory space and never touching the disk.

## Characteristics
- **No Files on Disk**: Operates without leaving files on the hard drive.
- **Memory-Resident**: Persists in the system's RAM.
- **Leverages Legitimate Tools**: Uses built-in system tools like PowerShell, WMI (Windows Management Instrumentation), and macros within Office documents.
- **Evades Detection**: Bypasses traditional antivirus solutions that scan for malicious files on disk.

## Attack Vectors
1. **Phishing Emails**: 
   - Contain malicious links or attachments that, when opened, execute fileless malware.
2. **Exploiting Vulnerabilities**:
   - Utilizes security flaws in software to execute code directly in memory.
3. **Malicious Macros**:
   - Embedded in documents (e.g., Word or Excel) that execute scripts when the document is opened.
4. **PowerShell Scripts**:
   - PowerShell commands or scripts executed to perform malicious activities.
  
## Classification
### According to *Evidence*
- No file activity performed.
- Indirect file activity: Using legitimate files which are supposed to be on the system and modifying these files to run some malicious code but still in the memory space.
- Files required: This file is not malicious and doesn't raise red flags, but it reaches to the internet, grap a malicious file, and read the content of that file into the memory, so basically nothing malicious is touching the disk.

### According to *Entry Points*
- Exploits & Network-based
- Hardware: eg. Spreading through infected USB drives.
- Execution & Injection (macro based, script based, disk based).

## Types of Fileless Malware
Fileless malware can be categorized based on the techniques it employs and the components it targets. Here are the main types:

### 1. Memory-Resident Malware
- **Characteristics**: Operates entirely in memory without writing files to the disk.
- **Example**: Fileless worms that propagate through network connections and remain in the RAM of infected systems.

### 2. Script-Based Malware
- **Characteristics**: Uses scripts (e.g., PowerShell, JavaScript, VBScript) to execute malicious activities.
- **Example**: Malicious PowerShell scripts embedded in phishing emails or documents.

### 3. Registry-Resident Malware
- **Characteristics**: Stores malicious code or scripts in the Windows Registry for persistence.
- **Example**: Malware that writes base64-encoded PowerShell commands to the registry and executes them using `regsvr32.exe`.

### 4. Reflective DLL Injection
- **Characteristics**: Injects Dynamic Link Libraries (DLLs) directly into the memory of running processes without writing to disk.
- **Example**: Malware that uses reflective DLL injection to load its payload into the memory space of legitimate processes.

### 5. Living off the Land (LotL) Attacks
- **Characteristics**: Exploits legitimate system tools and software to carry out malicious activities.
- **Example**: Using `wmic.exe`, `powershell.exe`, or `mshta.exe` to download and execute malicious scripts.

### 6. Office Document Macros
- **Characteristics**: Embeds malicious macros in Office documents (e.g., Word, Excel) that execute when the document is opened.
- **Example**: A Word document with a malicious VBA macro that executes PowerShell commands.

### 7. Bootkits
- **Characteristics**: Reside in the system's boot sector or bootloader, often leveraging firmware or system-level exploits.
- **Example**: Malware that infects the Master Boot Record (MBR) to load its payload directly into memory during the boot process.

### 8. Browser-Based Fileless Malware
- **Characteristics**: Executes through web browsers using malicious scripts or exploits delivered via websites.
- **Example**: Exploit kits that use JavaScript to execute malicious payloads in the browser's memory.

## Examples of Fileless Malware
1. **Poweliks**:
   - Uses registry keys to store and execute malicious PowerShell scripts.
2. **SamSam**:
   - Ransomware that exploits vulnerabilities to run in memory and encrypt files.
3. **Kovter**:
   - Ad-fraud malware that maintains persistence through registry manipulation.
4. **Powersniff**:
   - Uses malicious PowerShell scripts to download and execute payloads directly in memory.

# Malware Countermeasures
